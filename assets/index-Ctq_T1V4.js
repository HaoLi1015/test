import{f as V}from"./index-DwLlSbug.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 */import{u as G}from"./usePagination-C2U8EQ-C.js";/* empty css               *//* empty css                  *//* empty css                     */import"./el-tooltip-l0sNRNKZ.js";/* empty css                   *//* empty css                  *//* empty css                */import{T as H}from"./index-Dliooj2m.js";import{n as Q,C as W,a2 as X,E as q,a7 as Y,l as Z,s as ee,ah as te,a8 as ae,a9 as le,B as oe,$ as ne,V as re}from"./element-BD9IHJJo.js";import{v as se,r as c,V as ie,c as ue,w as pe,x as d,y as de,S as E,J as g,K as t,M as a,u as i,B as z,a3 as s,P as fe}from"./vue-C2mfnOEg.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-gSuEEdzx.js";function ce(){return V({url:"/staff-management-table",method:"get"})}function ge(v){return V({url:"/change-staff-status",method:"put",data:v})}function _e(v){return V({url:"/chagne/staff-details",method:"put",data:v})}const ve=[{prop:"qy_staff_id",label:"企业微信ID",type:"input"},{prop:"name",label:"姓名",type:"input"},{prop:"role",label:"角色",type:"select",options:[{label:"角色1",value:"v1"},{label:"角色2",value:"v2"},{label:"角色3",value:"v3"}]},{prop:"status",label:"状态",type:"select",options:[{label:"可用",value:!0},{label:"禁用",value:!1}]}],ye={class:"app-container"},be={class:"table-wrapper"},Ce={class:"pager-wrapper"},he={class:"dialog-footer"},Se=se({__name:"index",setup(v){const y=c(!1),b=c(!1),_=c(!1),{paginationData:n,handleCurrentChange:P,handleSizeChange:F}=G(),r=ie({}),w=c(),C=c(!1);function B(l){n.currentPage=1}function T(){n.currentPage=1}const x=c([]),I=ue(()=>{const l=(n.currentPage-1)*n.pageSize,e=l+n.pageSize;return x.value.slice(l,e)});function U(){y.value=!0,ce().then(l=>{x.value=l.data,n.total=l.data.length}).catch(l=>console.error(l)).finally(()=>{y.value=!1})}function $(l){Object.assign(r,l),_.value=!0}async function L(l){C.value=!0,l&&await l.validate((e,f)=>{if(e){const u={qy_staff_id:r.qy_staff_id,name:r.name,role:r.role};_e(u).then(m=>{q.success("更新成功"),_.value=!1}).catch(m=>console.error(m)).finally(()=>C.value=!1)}})}const M={id:[{required:!0,message:"请输入企业微信ID",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]};function N(l){const e={qy_staff_id:l.qy_staff_id,status:!l.status};b.value=!0,ge(e).then(f=>{l.status=!l.status}).catch(f=>{console.error(f),q.error("修改状态失败")}).finally(()=>{b.value=!1})}return pe([()=>n.currentPage,()=>n.pageSize],U,{immediate:!0}),(l,e)=>{const f=Q,u=Y,m=Z,p=ee,j=te,J=ae,K=le,h=oe,S=ne,O=re,R=W,D=X;return d(),de("div",ye,[E((d(),g(f,{shadow:"never",class:"search-wrapper"},{default:t(()=>[a(H,{fields:i(ve),onSearch:B,onReset:T},null,8,["fields"])]),_:1})),[[D,y.value]]),E((d(),g(f,{shadow:"never"},{default:t(()=>[z("div",be,[a(J,{data:I.value,"header-cell-style":{fontSize:"15px"}},{default:t(()=>[a(u,{prop:"qy_staff_id",label:"企业微信ID",align:"center"}),a(u,{prop:"name",label:"姓名",align:"center"}),a(u,{prop:"role",label:"角色",align:"center"},{default:t(o=>[a(m,{type:"primary",effect:"plain"},{default:t(()=>[s(fe(o.row.role),1)]),_:2},1024)]),_:1}),a(u,{prop:"status",label:"状态",align:"center"},{default:t(o=>[o.row.status===!0?(d(),g(m,{key:0,type:"success",effect:"plain"},{default:t(()=>e[6]||(e[6]=[s(" 可用 ")])),_:1})):(d(),g(m,{key:1,type:"danger",effect:"plain"},{default:t(()=>e[7]||(e[7]=[s(" 禁用 ")])),_:1}))]),_:1}),a(u,{fixed:"right",label:"操作",width:"150",align:"center"},{default:t(o=>[a(p,{type:"primary",size:"small",text:"",bg:"",onClick:k=>$(o.row)},{default:t(()=>e[8]||(e[8]=[s(" 修改 ")])),_:2},1032,["onClick"]),a(j,{title:o.row.status?"确定将该用户禁用吗？":"确定将该用户设置为可用吗？",onConfirm:k=>N(o.row),placement:"top"},{reference:t(()=>[o.row.status?(d(),g(p,{key:0,size:"small",type:"danger",bg:""},{default:t(()=>e[9]||(e[9]=[s(" 禁用 ")])),_:1})):(d(),g(p,{key:1,type:"success",size:"small",bg:""},{default:t(()=>e[10]||(e[10]=[s(" 可用 ")])),_:1}))]),actions:t(({confirm:k,cancel:A})=>[a(p,{size:"small",onClick:A},{default:t(()=>e[11]||(e[11]=[s(" 取消 ")])),_:2},1032,["onClick"]),a(p,{type:"primary",size:"small",onClick:k,loading:b.value},{default:t(()=>e[12]||(e[12]=[s(" 确定 ")])),_:2},1032,["onClick","loading"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])]),z("div",Ce,[a(K,{background:"",layout:i(n).layout,"page-sizes":i(n).pageSizes,total:i(n).total,"page-size":i(n).pageSize,"current-page":i(n).currentPage,onSizeChange:i(F),onCurrentChange:i(P)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})),[[D,y.value]]),a(R,{"destroy-on-close":"",draggable:"",modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=o=>_.value=o),title:"修改员工信息",width:"500",class:"dialog-centered","close-on-click-modal":!1},{footer:t(()=>[z("div",he,[a(p,{onClick:e[3]||(e[3]=o=>_.value=!1)},{default:t(()=>e[13]||(e[13]=[s(" 取消 ")])),_:1}),a(p,{type:"primary",onClick:e[4]||(e[4]=o=>L(w.value)),loading:C.value},{default:t(()=>e[14]||(e[14]=[s(" 确认 ")])),_:1},8,["loading"])])]),default:t(()=>[a(O,{"label-width":"auto",ref_key:"updateFormRef",ref:w,model:r,rules:M,style:{padding:"20px 20px 0 20px"}},{default:t(()=>[a(S,{label:"企业微信ID:",prop:"qy_staff_id"},{default:t(()=>[a(h,{modelValue:r.qy_staff_id,"onUpdate:modelValue":e[0]||(e[0]=o=>r.qy_staff_id=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(S,{label:"姓名:",prop:"name"},{default:t(()=>[a(h,{modelValue:r.name,"onUpdate:modelValue":e[1]||(e[1]=o=>r.name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(S,{label:"角色:",prop:"role"},{default:t(()=>[a(h,{modelValue:r.role,"onUpdate:modelValue":e[2]||(e[2]=o=>r.role=o),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Je=me(Se,[["__scopeId","data-v-bd337c1b"]]);export{Je as default};
